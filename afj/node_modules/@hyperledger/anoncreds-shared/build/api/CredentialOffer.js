"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CredentialOffer = void 0;
const AnoncredsObject_1 = require("../AnoncredsObject");
const register_1 = require("../register");
const KeyCorrectnessProof_1 = require("./KeyCorrectnessProof");
const utils_1 = require("./utils");
class CredentialOffer extends AnoncredsObject_1.AnoncredsObject {
    static create(options) {
        let credentialOfferHandle;
        // Objects created within this method must be freed up
        const objectHandles = [];
        try {
            const keyCorrectnessProof = options.keyCorrectnessProof instanceof KeyCorrectnessProof_1.KeyCorrectnessProof
                ? options.keyCorrectnessProof.handle
                : (0, utils_1.pushToArray)(KeyCorrectnessProof_1.KeyCorrectnessProof.fromJson(options.keyCorrectnessProof).handle, objectHandles);
            credentialOfferHandle = register_1.anoncreds.createCredentialOffer({
                schemaId: options.schemaId,
                credentialDefinitionId: options.credentialDefinitionId,
                keyCorrectnessProof,
            }).handle;
        }
        finally {
            objectHandles.forEach((handle) => handle.clear());
        }
        return new CredentialOffer(credentialOfferHandle);
    }
    static fromJson(json) {
        return new CredentialOffer(register_1.anoncreds.credentialOfferFromJson({ json: JSON.stringify(json) }).handle);
    }
}
exports.CredentialOffer = CredentialOffer;
//# sourceMappingURL=CredentialOffer.js.map