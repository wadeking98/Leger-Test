"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.serializeArguments = void 0;
const ref_napi_1 = require("@2060.io/ref-napi");
const aries_askar_shared_1 = require("@hyperledger/aries-askar-shared");
const conversion_1 = require("./conversion");
const serialize = (arg) => {
    switch (typeof arg) {
        case 'undefined':
            return ref_napi_1.NULL;
        case 'boolean':
            return +arg;
        case 'string':
            return arg;
        case 'number':
            return arg;
        case 'function':
            return arg;
        case 'object':
            if (arg instanceof Date) {
                return arg.valueOf();
            }
            else if (arg instanceof aries_askar_shared_1.ArcHandle ||
                arg instanceof aries_askar_shared_1.StoreHandle ||
                arg instanceof aries_askar_shared_1.SessionHandle ||
                arg instanceof aries_askar_shared_1.ScanHandle) {
                return arg.handle;
            }
            else if (arg instanceof aries_askar_shared_1.Key) {
                return arg.handle.handle;
            }
            else if (arg instanceof Buffer) {
                return arg;
            }
            else if (arg instanceof Uint8Array) {
                return (0, conversion_1.uint8arrayToByteBufferStruct)(Buffer.from(arg));
            }
            else if (arg instanceof aries_askar_shared_1.Jwk) {
                return (0, conversion_1.uint8arrayToByteBufferStruct)(Buffer.from(arg.toUint8Array()));
            }
            else {
                return JSON.stringify(arg);
            }
        default:
            throw new Error('could not serialize value');
    }
};
const serializeArguments = (args) => {
    const retVal = {};
    Object.entries(args).forEach(([key, val]) => (retVal[key] = serialize(val)));
    return retVal;
};
exports.serializeArguments = serializeArguments;
//# sourceMappingURL=serialize.js.map